<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
// Configuração do Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBrkKTDKcKA16a1fL4mR3VKjArmxBUb8ho",
  authDomain: "coderaw-2025.firebaseapp.com",
  databaseURL: "https://coderaw-2025-default-rtdb.firebaseio.com",
  projectId: "coderaw-2025",
  storageBucket: "coderaw-2025.firebasestorage.app",
  messagingSenderId: "134498624143",
  appId: "1:134498624143:web:706e250b656061732046fa",
  measurementId: "G-GV2X7STJQD"
};

firebase.initializeApp(firebaseConfig);

// Pegar ID da URL
const urlParams = new URLSearchParams(window.location.search);
const codeId = urlParams.get('id');

if (!codeId) {
    // Se não tem ID, mostra erro
    document.write('print("Erro: ID não especificado na URL")');
} else {
    const database = firebase.database();
    
    // Buscar no Firebase
    database.ref('raws/' + codeId).once('value')
        .then((snapshot) => {
            if (snapshot.exists()) {
                const data = snapshot.val();
                
                // ESCREVER O CÓDIGO LUA DIRETAMENTE
                // O loadstring vai ignorar todo o HTML/JavaScript e só executar isto
                document.write(data.code || 'print("Código vazio")');
                
                // Atualizar visualizações
                const currentViews = data.views || 0;
                database.ref('raws/' + codeId + '/views').set(currentViews + 1);
                
            } else {
                document.write('print("Erro: Código não encontrado - ID: ' + codeId + '")');
            }
        })
        .catch((error) => {
            document.write('print("Erro: Não foi possível carregar o código")');
        });
}
</script>
